<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>【DQM3】体験版で作れるモンスターから作れるEランク以上のモンスター集</title>
    <style>
        /* スタイルを追加することができます */
        .success {
            color: green;
        }
        .failure {
            color: red;
        }
    </style>
</head>
<body>
    <h1>文章の評価</h1>
    <ul>
        <li>
            <strong>スカルガルー+みみとびねずみ</strong>
            <span class="success">〇→エビルハムスター</span>
        </li>
        <li>
            <strong>スカルガルー+ももんじゃ</strong>
            <span class="success">〇→ダックスビル</span>
        </li>
        <li>
            <strong>スカルライダー+ミイラおとこ</strong>
            <span class="success">〇→しのどれい</span>
        </li>
        <li>
            <strong>スノーム+とげジョボー</strong>
            <span class="success">〇→スピンスライム</span>
        </li>
        <li>
            <strong>スライム+デンデン竜</strong>
            <span class="success">〇→もりもりスライム</span>
        </li>
        <li>
            <strong>タップペンギー+わらいぶくろ</strong>
            <span class="success">〇→おどる宝石</span>
        </li>
        <li>
            <strong>タップペンギー+ベビーサタン</strong>
            <span class="success">〇→キメラ</span>
        </li>
        <li>
            <strong>タップペンギー+ナスビナーラ</strong>
            <span class="success">〇→メランザーナ</span>
        </li>
        <li>
            <strong>チョコゴーレム+ホイップゴースト</strong>
            <span class="success">〇→チョコホイップ</span>
        </li>
        <li>
            <strong>デンデン竜+ポイズンリザード</strong>
            <span class="success">〇→毒つぼドラゴン</span>
        </li>
        <li>
            <strong>ドラゴスライム+ビッグハット</strong>
            <span class="success">〇→トンブレロ</span>
        </li>
        <li>
            <strong>ドルイド+ミステリードール</strong>
            <span class="success">〇→きめんどうし</span>
        </li>
        <li>
            <strong>どんぐりベビー+ホイミスライム</strong>
            <span class="success">〇→エンゼルスライム</span>
        </li>
        <li>
            <strong>ドロヌーバ＋ぶちスライム</strong>
            <span class="success">〇→ストーンスライム</span>
        </li>
        <li>
            <strong>バブルスライム+ボックススライム</strong>
            <span class="success">〇→スライムタール</span>
        </li>
        <li>
            <strong>びっくりサタン+ひとくいサーベル</strong>
            <span class="success">〇→ベレス</span>
        </li>
        <li>
            <strong>マッシュスライム+マドハンド</strong>
            <span class="success">〇→ぬかどこスライム</span>
        </li>
        <li>
            <strong>ミステリードール+ランタンこぞう</strong>
            <span class="success">〇→エンタシスマン</span>
        </li>
        <li>
            <strong>メタルハンター+シールドこぞう</strong>
            <span class="success">〇→シールドオーガ</span>
        </li>
        <li>
            <strong>～系統～</strong>
        </li>
        <li>
            <strong>F悪魔系+スライム系</strong>
            <span class="success">〇→ダークスライム</span>
        </li>
        <li>
            <strong>アイアンタートル+魔獸系</strong>
            <span class="success">〇→ガメゴン</span>
        </li>
        <li>
            <strong>キャットフライ+悪魔系</strong>
            <span class="success">〇→ねこまどう</span>
        </li>
        <li>
            <strong>クロコマーチ+ゾンビ系</strong>
            <span class="success">〇→毒つぼドラゴン</span>
        </li>
        <li>
            <strong>シーメーダ+魔獸系</strong>
            <span class="success">〇→ビッグアイ</span>
        </li>
        <li>
            <strong>かまいたち+びっくりサタン</strong>
            <span class="success">〇→サタンフーラー</span>
        </li>
        <li>
            <strong>かまいたち+メタッピー</strong>
            <span class="success">〇→ガチャコッコ</span>
        </li>
        <li>
            <strong>ギズモ+スノーム</strong>
            <span class="success">〇→フロストギズモ</span>
        </li>
        <li>
            <strong>ギズモ+ドラゴスライム</strong>
            <span class="success">〇→ヒートギズモ</span>
        </li>
        <li>
            <strong>キラーコーン+ズッキーニャ</strong>
            <span class="success">〇→ビーンファイター</span>
        </li>
        <li>
            <strong>キラーコーン+はさみくわがた</strong>
            <span class="success">〇→キラービー</span>
        </li>
        <li>
            <strong>くさったしたい+リリパット</strong>
            <span class="success">〇→どくやずきん</span>
        </li>
        <li>
            <strong>くらやみハーピー+ミステリードール</strong>
            <span class="success">〇→メイデンドール</span>
        </li>
        <li>
            <strong>クロコマーチ+さまようよろい</strong>
            <span class="success">〇→毒つぼドラゴン</span>
        </li>
        <li>
            <strong>ごろつき+ランドセーラー</strong>
            <span class="success">〇→オーガー</span>
        </li>
        <li>
            <strong>コンジュラー+ドラキー</strong>
            <span class="success">〇→メイジドラキー</span>
        </li>
        <li>
            <strong>さまようよろい+スマイルリザード</strong>
            <span class="success">〇→リザードマン</span>
        </li>
        <li>
            <strong>しましまキャット+ランドセーラー</strong>
            <span class="success">〇→プリズニャン</span>
        </li>
        <li>
            <strong>シャドー+ベビーパンサー</strong>
            <span class="success">〇→シャドウベビー</span>
        </li>
        <li>
            <strong>アイアンタートル+ウィングスネーク</strong>
            <span class="success">〇→ガメゴン</span>
        </li>
        <li>
            <strong>アイアンタートル+ダッシュラン</strong>
            <span class="success">〇→デンタザウルス</span>
        </li>
        <li>
            <strong>アニマルゾンビ+あばれうしどり</strong>
            <span class="success">〇→デットペッカー</span>
        </li>
        <li>
            <strong>イエティ+ファーラット</strong>
            <span class="success">〇→モコモコじゅう</span>
        </li>
        <li>
            <strong>いっかくうさぎ+ゆめにゅうどう</strong>
            <span class="success">〇→アルミラージ</span>
        </li>
        <li>
            <strong>いっかく竜+ひとくいサーベル</strong>
            <span class="success">〇→ソードドラゴン</span>
        </li>
        <li>
            <strong>いばらドラゴン+ダッシュラン</strong>
            <span class="success">〇→フォレストドラゴ</span>
        </li>
        <li>
            <strong>オーク+オクトリーチ</strong>
            <span class="success">〇→タコメット</span>
        </li>
        <li>
            <strong>オーク＋ベビーパンサー</strong>
            <span class="success">〇→かくとうパンサー</span>
        </li>
        <li>
            <strong>おおめだま+ミステリードール</strong>
            <span class="success">〇→スペクテッド</span>
        </li>
        <li>
            <strong>おにこぞう+ベビーマジシャン</strong>
            <span class="success">〇→ひとつめピエロ</span>
        </li>
        <li>
            <strong>おばけキノコ+ゆめにゅうどう</strong>
            <span class="success">〇→マージマタンゴ</span>
        </li>
        <li>
            <strong>がいこつ+さまようよろい</strong>
            <span class="success">〇→しりょうのきし</span>
        </li>
    </ul>
    <div id="result">
        <p>この記事が役に立ったか評価してください：</p>
        <p id="sentence">あ！</p>
        <button id="yesButton">Yes</button>
        <button id="noButton">No</button>
    </div>
    <div id="voteCounts">
        <p>Yes: <span id="yesCount">0</span></p>
        <p>No: <span id="noCount">0</span></p>
    </div>

    <script>
        const userId = getUserId();
        let hasVoted = checkIfUserHasVoted();
        let yesCount = 0;
        let noCount = 0;
        let isDisplayed = false;

        const yesButton = document.getElementById("yesButton");
        const noButton = document.getElementById("noButton");
        const resultDiv = document.getElementById("result");
        const sentenceElement = document.getElementById("sentence");
        const yesCountDisplay = document.getElementById("yesCount");
        const noCountDisplay = document.getElementById("noCount");

        if (hasVoted) {
            yesButton.disabled = true;
            noButton.disabled = true;
        }

        yesButton.addEventListener("click", function () {
            if (!hasVoted && !isDisplayed) {
                yesCount++;
                storeUserVote();
                updateVoteCounts();
                checkAndDisplay();
            }
        });

        noButton.addEventListener("click", function () {
            if (!hasVoted && !isDisplayed) {
                noCount++;
                storeUserVote();
                updateVoteCounts();
                checkAndDisplay();
            }
        });

        function checkAndDisplay() {
            if (!isDisplayed) {
                const totalVotes = yesCount + noCount;
                const yesPercentage = (yesCount / totalVotes) * 100;

                if (yesPercentage >= 50) {
                    isDisplayed = true;
                    sentenceElement.style.display = "block";
                }
            }
        }

        function getUserId() {
            return Math.random().toString(36).substring(2, 15);
        }

        function storeUserVote() {
            const votedUsers = getVotedUsers();
            votedUsers.push(userId);
            setCookie("votedUsers", JSON.stringify(votedUsers));
            hasVoted = true;
            yesButton.disabled = true;
            noButton.disabled = true;
        }

        function checkIfUserHasVoted() {
            const votedUsers = getVotedUsers();
            return votedUsers.includes(userId);
        }

        function getVotedUsers() {
            const votedUsersCookie = getCookie("votedUsers");
            return votedUsersCookie ? JSON.parse(votedUsersCookie) : [];
        }

        function setCookie(name, value, days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            const expires = "expires=" + date.toUTCString();
            document.cookie = name + "=" + value + ";" + expires + ";path=/";
        }

        function getCookie(name) {
            const cookieName = name + "=";
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                let cookie = cookies[i];
                while (cookie.charAt(0) === ' ') {
                    cookie = cookie.substring(1);
                }
                if (cookie.indexOf(cookieName) === 0) {
                    return cookie.substring(cookieName.length, cookie.length);
                }
            }
            return "";
        }

        function updateVoteCounts() {
            // 投票数を表示する関数
            yesCountDisplay.textContent = yesCount;
            noCountDisplay.textContent = noCount;
        }

        // ページロード時に投票数を表示
        updateVoteCounts();

        // ユーザーの投票をサーバーに送信する関数を追加
        function sendVote(vote) {
            const userId = getUserId();
            fetch('/record-vote.php', {
                method: 'POST',
                body: JSON.stringify({ userId, vote }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // 投票成功時の処理
                    // ボタンを無効にする
                    yesButton.disabled = true;
                    noButton.disabled = true;
                } else {
                    // 投票エラー時の処理

                }
            })
            .catch(error => {
                // エラーハンドリング
                
            });
        }

        // 他のコードは前回の回答を参照
        // ...

        yesButton.addEventListener("click", function () {
            if (!hasVoted && !isDisplayed) {
                yesCount++;
                sendVote("Yes"); // サーバーにYesを送信
                updateVoteCounts();
                checkAndDisplay();
            }
        });

        noButton.addEventListener("click", function () {
            if (!hasVoted && !isDisplayed) {
                noCount++;
                sendVote("No"); // サーバーにNoを送信
                updateVoteCounts();
                checkAndDisplay();
            }
        });
    </script>
</body>
</html>
